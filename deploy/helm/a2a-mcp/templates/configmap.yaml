apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "a2a-mcp.fullname" . }}-config
  labels:
    {{- include "a2a-mcp.labels" . | nindent 4 }}
data:
  OIDC_ISSUER: {{ .Values.oidc.issuer | quote }}
  OIDC_AUDIENCE: {{ .Values.oidc.audience | quote }}
  OIDC_JWKS_URL: {{ .Values.oidc.jwksUrl | quote }}
  OIDC_ALLOWED_REPOSITORIES: {{ .Values.oidc.allowedRepositories | quote }}
  OIDC_ALLOWED_ACTORS: {{ .Values.oidc.allowedActors | quote }}
  OIDC_ENFORCE: {{ .Values.oidc.enforce | quote }}
  DATABASE_MODE: {{ .Values.database.mode | quote }}
{{- if eq .Values.database.mode "sqlite" }}
  SQLITE_PATH: {{ .Values.database.sqlite.path | quote }}
{{- else }}
  POSTGRES_HOST: {{ include "a2a-mcp.postgresServiceName" . | quote }}
  POSTGRES_PORT: {{ .Values.database.postgres.servicePort | quote }}
  POSTGRES_DB: {{ .Values.database.postgres.credentials.database | quote }}
{{- end }}
